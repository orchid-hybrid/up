int key_exchange(unsigned char *a_pk,
                 unsigned char *a_sk,
                 unsigned char *b_pk,
                 unsigned char *key,
                 int mode,
                 int sock);